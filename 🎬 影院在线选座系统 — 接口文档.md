# 🎬 影院在线选座系统 — 前端接口文档

> **适用对象**：前端开发人员 / 全栈开发者  
> **认证方式**：JWT Token（登录后在 Header 中携带）  
> **基础 URL**：`http://localhost:8080`（开发环境）

---

## 1. 用户认证

### 1.1 用户登录
- **请求路径**：`/login`  
- **请求方式**：`POST`  
- **接口描述**：用户通过用户名和密码登录系统，成功后返回 JWT 令牌。  

#### 请求参数（Body，application/json）
| 字段名   | 类型   | 必填 | 说明                |
| -------- | ------ | ---- | ------------------- |
| username | string | 是   | 用户名（如：user1） |
| password | string | 是   | 密码（如：123456）  |

**请求示例**：
```json
{
  "username": "user1",
  "password": "123456"
}
```

#### 响应数据（application/json）
| 字段 | 类型   | 说明                           |
| ---- | ------ | ------------------------------ |
| code | number | 状态码（1=成功，0=失败）       |
| msg  | string | 提示信息                       |
| data | object | 登录成功时返回用户信息和 token |

**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "id": 1,
    "username": "user1",
    "name": "张三",
    "token": "eyJhbGciOiJIUzI1NiJ9.xxxxx"
  }
}
```

> 🔐 **后续所有接口**（除 `/login` 外）均需在请求头中携带：
> ```
> token: eyJhbGciOiJIUzI1NiJ9.xxxxx
> ```
> 若未携带或 token 无效，后端将返回 HTTP 状态码 `401`。

---

## 2. 影院与排片查询

### 2.1 获取影院列表
- **请求路径**：`/cinemas`  
- **请求方式**：`GET`  
- **接口描述**：获取所有可选影院信息。

#### 响应数据
**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": [
    {
      "id": 1,
      "name": "UME华星国际影城",
      "location": "北京市海淀区中关村大街1号"
    },
    {
      "id": 2,
      "name": "万达影城（CBD店）",
      "location": "北京市朝阳区建国路88号"
    }
  ]
}
```

---

### 2.2 获取某影院的电影排片（按日期）
- **请求路径**：`/schedules`  
- **请求方式**：`GET`  
- **接口描述**：查询指定影院在某一天的所有电影排片。

#### 请求参数（Query）
| 参数名   | 类型   | 必填 | 说明                                |
| -------- | ------ | ---- | ----------------------------------- |
| cinemaId | number | 是   | 影院ID                              |
| date     | string | 否   | 日期，格式 `YYYY-MM-DD`，默认为当天 |

#### 响应数据
**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": [
    {
      "id": 101,
      "movieId": 1,
      "movieTitle": "阿凡达：水之道",
      "hallId": 5,
      "hallName": "IMAX厅",
      "startTime": "2025-12-20T19:30:00",
      "endTime": "2025-12-20T22:42:00"
    },
    {
      "id": 102,
      "movieId": 2,
      "movieTitle": "奥本海默",
      "hallId": 3,
      "hallName": "杜比全景声厅",
      "startTime": "2025-12-20T20:00:00",
      "endTime": "2025-12-20T23:00:00"
    }
  ]
}
```

---

## 3. 座位与选座

### 3.1 获取某场次座位图
- **请求路径**：`/schedules/{scheduleId}/seats`  
- **请求方式**：`GET`  
- **接口描述**：获取指定场次的座位布局及状态。

#### 路径参数
| 参数名     | 类型   | 必填 | 说明   |
| ---------- | ------ | ---- | ------ |
| scheduleId | number | 是   | 场次ID |

#### 响应数据
**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "hallName": "IMAX厅",
    "rows": 10,
    "cols": 15,
    "seats": [
      {
        "id": 1001,
        "row": 1,
        "col": 1,
        "status": "AVAILABLE",
        "type": "NORMAL"
      },
      {
        "id": 1002,
        "row": 1,
        "col": 2,
        "status": "LOCKED",
        "type": "VIP"
      },
      {
        "id": 1003,
        "row": 1,
        "col": 3,
        "status": "SOLD",
        "type": "NORMAL"
      }
    ]
  }
}
```

> 📌 **status 枚举值**：
> - `AVAILABLE`：可选
> - `LOCKED`：已被其他用户锁定（待支付）
> - `SOLD`：已售出  
>   
>
> 📌 **type 枚举值**：`NORMAL` / `VIP`

---

### 3.2 锁定座位并创建订单
- **请求路径**：`/orders`  
- **请求方式**：`POST`  
- **接口描述**：锁定指定座位，生成待支付订单（有效期15分钟）。

#### 请求参数（Body，application/json）
| 字段名     | 类型     | 必填 | 说明               |
| ---------- | -------- | ---- | ------------------ |
| scheduleId | number   | 是   | 场次ID             |
| seatIds    | number[] | 是   | 要锁定的座位ID数组 |

**请求示例**：
```json
{
  "scheduleId": 101,
  "seatIds": [1001, 1003]
}
```

#### 响应数据
**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "orderId": 501,
    "expiresAt": "2025-12-20T20:15:00",
    "lockedSeats": [1001, 1003]
  }
}
```

**失败响应示例（部分座位不可用）**：
```json
{
  "code": 0,
  "msg": "以下座位不可用: [1001]",
  "data": null
}
```

---

## 4. 订单管理

### 4.1 模拟支付订单
- **请求路径**：`/orders/{orderId}/pay`  
- **请求方式**：`POST`  
- **接口描述**：模拟用户完成支付，将订单状态更新为“已支付”。

#### 路径参数
| 参数名  | 类型   | 必填 | 说明   |
| ------- | ------ | ---- | ------ |
| orderId | number | 是   | 订单ID |

#### 响应数据
**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": null
}
```

---

### 4.2 查询当前用户订单列表
- **请求路径**：`/orders`  
- **请求方式**：`GET`  
- **接口描述**：获取当前登录用户的所有订单。

#### 响应数据
**成功响应示例**：
```json
{
  "code": 1,
  "msg": "success",
  "data": [
    {
      "id": 501,
      "scheduleId": 101,
      "movieTitle": "阿凡达：水之道",
      "hallName": "IMAX厅",
      "startTime": "2025-12-20T19:30:00",
      "seatNumbers": ["1排1座", "1排3座"],
      "status": "PAID",
      "createdAt": "2025-12-20T19:00:00"
    }
  ]
}
```

> 📌 **status 枚举值**：`PENDING`（待支付）、`PAID`（已支付）、`CANCELLED`（已取消）
